<apex:page showHeader="false" sidebar="false" standardStylesheets="false">
    <html>
        <head>
            <title>Genesys Cloud Authentication</title>
            <script type="text/javascript">
                window.onload = function() {
                    // Parse URL parameters for authorization code
                    const urlParams = new URLSearchParams(window.location.search);
                    const authCode = urlParams.get('code');
                    const error = urlParams.get('error');
                    
                    if (authCode) {
                        // Send authorization code to parent window
                        window.opener.postMessage({
                            type: 'GENESYS_AUTH_CALLBACK',
                            code: authCode
                        }, window.location.origin);
                        
                        // Close this window
                        setTimeout(function() {
                            window.close();
                        }, 500);
                    } else if (error) {
                        document.getElementById('message').innerHTML = 'Authentication failed: ' + error;
                    } else {
                        document.getElementById('message').innerHTML = 'Authentication failed. No authorization code received.';
                    }
                };
            </script>
        </head>
        <body>
            <div style="text-align: center; padding: 20px; font-family: Arial, sans-serif;">
                <h2>Genesys Cloud Authentication</h2>
                <p>Authentication complete. This window will close automatically.</p>
                <p id="message"></p>
            </div>
        </body>
    </html>
</apex:page>